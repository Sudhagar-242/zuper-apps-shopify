<link rel="stylesheet" href="{{ 'section-custom-faq.css' | asset_url }}" media="print" onload="this.media='all'">

<section class="faq-section">
  <!-- Tag Label -->
  <div class="faq-tag">
    <span>FAQs</span>
  </div>

  <!-- Heading -->
  <h2 class="faq-title">Frequently Asked Question</h2>

  <!-- Subtitle -->
  <p class="faq-subtitle">
    Find quick answers about zuperapps features, security, automation, and earning options. Get the information you need
    to trade smarter
  </p>

  <!-- FAQ Items -->
  <div class="faq-list">
    {%- for block in section.blocks -%}
      <details
        id="Details-{{ block.id }}-{{ section.id }}"
        {% if section.settings.open_first_collapsible_row and forloop.first %}
          open
        {% endif %}
        class="custom_details_class styled"
      >
        <summary id="Summary-{{ block.id }}-{{ section.id }}">
          {% render 'icon-accordion', icon: block.settings.icon %}
          <h3 class="">
            {{ block.settings.heading | default: block.settings.page.title | escape }}
          </h3>
          <div class="expand_plus">
            <svg class="accordion-caret">
              {{- 'icon-plus.svg' | inline_asset_content -}}
            </svg>
          </div>
          <div class="expand_minus">
            <svg class="accordion-caret">
              {{- 'icon-minus.svg' | inline_asset_content -}}
            </svg>
          </div>
        </summary>
        <div
          class="content_container content"
          id="CollapsibleAccordion-{{ block.id }}-{{ section.id }}"
          role="region"
          aria-labelledby="Summary-{{ block.id }}-{{ section.id }}"
        >
          {{ block.settings.row_content }}
          {{ block.settings.page.content }}
        </div>
      </details>
    {%- endfor -%}
  </div>
  <div class="faq-cta">
    <a href="#" class="faq-button">Ask a Question</a>
  </div>
</section>

{% javascript %}
  document.addEventListener('DOMContentLoaded', () => {
    const detailsElements = document.querySelectorAll('details.custom_details_class');

    detailsElements.forEach((details) => {
      const summary = details.querySelector('details.custom_details_class summary');
      const content = details.querySelector('.content_container');

      // Remove native toggle behavior
      summary.addEventListener('click', (event) => {
        event.preventDefault();

        const isOpen = details.hasAttribute('open');

        // Collapse all other details (optional: accordion behavior)
        document.querySelectorAll('details.custom_details_class[open]').forEach((openItem) => {
          if (openItem !== details) {
            collapse(openItem);
          }
        });

        if (isOpen) {
          collapse(details);
        } else {
          expand(details);
        }
      });

      const expand = (el) => {
        const content = el.querySelector('.content_container');
        el.setAttribute('open', true);
        content.style.height = '0px'; // Start from 0
        const height = content.scrollHeight + 'px';
        requestAnimationFrame(() => {
          content.style.height = height;
        });
        content.addEventListener(
          'transitionend',
          () => {
            content.style.height = 'auto'; // Reset to auto after animation
          },
          { once: true }
        );
      };

      const collapse = (el) => {
        const content = el.querySelector('.content_container');
        content.style.height = content.scrollHeight + 'px'; // Set current height
        requestAnimationFrame(() => {
          content.style.height = '0px';
        });
        content.addEventListener(
          'transitionend',
          () => {
            el.removeAttribute('open');
          },
          { once: true }
        );
      };
      expand(detailsElements[0]);
    });
  });
{% endjavascript %}

{% schema %}
{
  "name": "Custom FAQs section",
  "tag": "section",
  "class": "faq_container",
  "settings": [
    {
      "type": "checkbox",
      "id": "open_first_collapsible_row",
      "default": false,
      "label": "t:sections.collapsible_content.settings.open_first_collapsible_row.label"
    }
  ],
  "blocks": [
    {
      "type": "collapsible_row",
      "name": "t:sections.collapsible_content.blocks.collapsible_row.name",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "default": "t:sections.collapsible_content.blocks.collapsible_row.settings.heading.default",
          "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.heading.label"
        },
        {
          "type": "select",
          "id": "icon",
          "options": [
            {
              "value": "none",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__1.label"
            },
            {
              "value": "apple",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__2.label"
            },
            {
              "value": "banana",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__3.label"
            },
            {
              "value": "bottle",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__4.label"
            },
            {
              "value": "box",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__5.label"
            },
            {
              "value": "carrot",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__6.label"
            },
            {
              "value": "chat_bubble",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__7.label"
            },
            {
              "value": "check_mark",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__8.label"
            },
            {
              "value": "clipboard",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__9.label"
            },
            {
              "value": "dairy",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__10.label"
            },
            {
              "value": "dairy_free",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__11.label"
            },
            {
              "value": "dryer",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__12.label"
            },
            {
              "value": "eye",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__13.label"
            },
            {
              "value": "fire",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__14.label"
            },
            {
              "value": "gluten_free",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__15.label"
            },
            {
              "value": "heart",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__16.label"
            },
            {
              "value": "iron",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__17.label"
            },
            {
              "value": "leaf",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__18.label"
            },
            {
              "value": "leather",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__19.label"
            },
            {
              "value": "lightning_bolt",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__20.label"
            },
            {
              "value": "lipstick",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__21.label"
            },
            {
              "value": "lock",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__22.label"
            },
            {
              "value": "map_pin",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__23.label"
            },
            {
              "value": "nut_free",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__24.label"
            },
            {
              "value": "pants",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__25.label"
            },
            {
              "value": "paw_print",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__26.label"
            },
            {
              "value": "pepper",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__27.label"
            },
            {
              "value": "perfume",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__28.label"
            },
            {
              "value": "plane",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__29.label"
            },
            {
              "value": "plant",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__30.label"
            },
            {
              "value": "price_tag",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__31.label"
            },
            {
              "value": "question_mark",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__32.label"
            },
            {
              "value": "recycle",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__33.label"
            },
            {
              "value": "return",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__34.label"
            },
            {
              "value": "ruler",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__35.label"
            },
            {
              "value": "serving_dish",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__36.label"
            },
            {
              "value": "shirt",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__37.label"
            },
            {
              "value": "shoe",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__38.label"
            },
            {
              "value": "silhouette",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__39.label"
            },
            {
              "value": "snowflake",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__40.label"
            },
            {
              "value": "star",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__41.label"
            },
            {
              "value": "stopwatch",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__42.label"
            },
            {
              "value": "truck",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__43.label"
            },
            {
              "value": "washing",
              "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.options__44.label"
            }
          ],
          "default": "check_mark",
          "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.icon.label"
        },
        {
          "type": "richtext",
          "id": "row_content",
          "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.row_content.label"
        },
        {
          "type": "page",
          "id": "page",
          "label": "t:sections.collapsible_content.blocks.collapsible_row.settings.page.label"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Custom FAQs section"
    }
  ]
}
{% endschema %}
